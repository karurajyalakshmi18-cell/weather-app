<!DOCTYPE html>
<html>
<head>
    <title>Weather App</title>
    <style>
        .spinner {
  display: none; /* by default hide */
  margin: 15px auto;
  border: 5px solid #f3f3f3;
  border-top: 5px solid #4facfe;
  border-radius: 50%;
  width: 40px;
  height: 40px;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
        body {
            font-family: Arial;
            text-align: center;
            background: linear-gradient(to right, #4facfe, #00f2fe);
            margin-top: 100px;
        }

        .card {
            background: white;
            padding: 20px;
            width: 300px;
            margin: auto;
            border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        input {
            padding: 8px;
            width: 70%;
        }

        button {
            padding: 8px;
            margin-top: 10px;
            cursor: pointer;
        }

        #result {
            margin-top: 20px;
            font-size: 18px;
        }
    </style>
    
</head>

<body>

<div class="card">
    <h2>Weather App üå§Ô∏è</h2>
    <input type="text" id="city" placeholder="Enter City Name">
    <br>
    <button onclick="getWeather()">Get Weather</button>
    <button onclick="getLocationWeather()">Current Location Weather</button>
    <div id="result"></div>
    <div class="spinner" id="spinner"></div>
</div>

<script>
const apiKey = "ffa4ae2f22d4376ac1bc215f121c2f22";

function getWeather() {
    const city = document.getElementById("city").value;
    document.getElementById("spinner").style.display = "block"; // start

    fetch(`https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric`)
    .then(response => response.json())
    .then(data => {
        displayWeather(data);
        document.getElementById("spinner").style.display = "none"; // hide
    })
    .catch(() => {
        document.getElementById("result").innerHTML = "City not found!";
        document.getElementById("spinner").style.display = "none"; // hide
    });
}

function getLocationWeather() {
    if(navigator.geolocation) {
        document.getElementById("spinner").style.display = "block";
        navigator.geolocation.getCurrentPosition(position => {
            const lat = position.coords.latitude;
            const lon = position.coords.longitude;

            fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${apiKey}&units=metric`)
            .then(response => response.json())
            .then(data => {
                displayWeather(data);
                 document.getElementById("spinner").style.display = "none";
                  })
            .catch(() => {
                document.getElementById("result").innerHTML = "Weather fetch failed!";
                document.getElementById("spinner").style.display = "none"; 
            });
        }, () => {
            alert("Location permission denied!");
            document.getElementById("spinner").style.display = "none"; 
        });
    } else {
        alert("Geolocation not supported by your browser.");
    }
}

function displayWeather(data) {
    let condition = data.weather[0].main.toLowerCase();
    let icon = "";
    let bg = "";

    if(condition.includes("rain")) { icon="üåß"; bg="linear-gradient(to right, #4e73df, #1cc88a)"; }
    else if(condition.includes("cloud")) { icon="‚òÅ"; bg="linear-gradient(to right, #757f9a, #d7dde8)"; }
    else if(condition.includes("clear")) { icon="‚òÄ"; bg="linear-gradient(to right, #f7971e, #ffd200)"; }
    else { icon="üåç"; bg="linear-gradient(to right, #2193b0, #6dd5ed)"; }

    document.getElementById("result").innerHTML =
        `<h2>${icon} ${data.name}</h2>
         <h1>${data.main.temp}¬∞C</h1>
         <p>${data.weather[0].description}</p>`;

    document.body.style.background = bg;
}
</script>

</body>
</html>
